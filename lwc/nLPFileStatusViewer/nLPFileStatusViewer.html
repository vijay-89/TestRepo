<template>
    <lightning-card class="" title="" icon-name="">
        <div class="slds-m-around_small slds-clearfix">
            <h2 class="slds-text-heading_large slds-text-title_bold"><img src={announcementImage} width="35" height="35"> {customLabels.NLPFileStatusViewer_ComponentTitle}</h2>
            <div class="slds-p-vertical--xx-small"></div>
            <template if:true={files}>
                <div style="overflow:auto;">
                    <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                        <thead>
                            <tr class="slds-line-height_reset">
                                <th class="" scope="col">
                                    <div class="slds-truncate" title="Name">{customLabels.NLPFileStatusViewer_ComponentTitle_FileName}</div>
                                </th>
                                <th class="" scope="col">
                                    <div class="slds-truncate" title="Name">{customLabels.NLPFileStatusViewer_ComponentTitle_TrackingName}</div>
                                </th>
                                <th class="" scope="col">
                                    <div class="slds-truncate" title="Name">{customLabels.NLPFileStatusViewer_ComponentTitle_Status}</div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <template for:each={files} for:item="file">
                                <tr key={file}>
                                    <td><lightning-formatted-url value={file.FileURL} tooltip={file.FullFileName} label={file.FileName} target="_blank" ></lightning-formatted-url></td>
                                    <td><lightning-formatted-url value={file.TrackingURL} tooltip="Go to the file" label={file.TrackingName} target="_blank" ></lightning-formatted-url></td>
                                    <td><div class={file.StatusTextColor}><lightning-formatted-text value={file.Status}></lightning-formatted-text></div></td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
                <div class="slds-float--right">
                    <div class="slds-p-right--medium"><lightning-button label="View All" variant="base" onclick={openmodal} ></lightning-button></div>
                </div>
            </template>
            <template if:true={error}>
                <p>There was an error on this LWC. Please contact support team.</p>
            </template>
        </div>

        <template if:true={openmodel}>
            <div class="demo-only" style="height: 640px;">
                <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                    <div class="slds-modal__container">
                        <header class="slds-modal__header">
                            <!-- <lightning-button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={closeModal}>
                                <lightning-icon icon-name="utility:close"
                                   alternative-text="close"
                                   variant="inverse"
                                   size="small" ></lightning-icon>
                                <span class="slds-assistive-text">Close</span>
                             </lightning-button> -->
                             <!-- lightning-button doesn't show correctly with the 'x' on the modal but html button does. Using html button for this reason. -->
                             <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={closeModal}>
                                <lightning-icon icon-name="utility:close"
                                   alternative-text="close"
                                   variant="inverse"
                                   size="small" ></lightning-icon>
                                <span class="slds-assistive-text">Close</span>
                             </button>
                            <h2 id="modal-heading-01" class="slds-text-heading_medium slds-text-title_bold"><img src={announcementImage} width="40" height="40"> {customLabels.NLPFileStatusViewer_ComponentTitle}</h2>
                        </header>
                        <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                            <template if:true={allFiles}>
                                <div style="overflow:auto;">
                                    <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                        <thead>
                                            <tr class="slds-line-height_reset">
                                                <th class="" scope="col">
                                                    <div class="slds-truncate" title="Name">{customLabels.NLPFileStatusViewer_ComponentTitle_FileName}</div>
                                                </th>
                                                <th class="" scope="col">
                                                    <div class="slds-truncate" title="Tracking">{customLabels.NLPFileStatusViewer_ComponentTitle_TrackingName}</div>
                                                </th>
                                                <th class="" scope="col">
                                                    <div class="slds-truncate" title="Status">{customLabels.NLPFileStatusViewer_ComponentTitle_Status}</div>
                                                </th>
                                                <th class="" scope="col">
                                                    <div class="slds-truncate" title="Details">{customLabels.NLPFileStatusViewer_ComponentTitle_Details}</div>
                                                </th>
                                                <th class="" scope="col">
                                                    <div class="slds-truncate" title="Date">{customLabels.NLPFileStatusViewer_ComponentTitle_CreatedDate}</div>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <template for:each={allFiles} for:item="file">
                                                <tr key={file}>
                                                    <td><lightning-formatted-url value={file.FileURL} tooltip={file.FullFileName} label={file.FileName} target="_blank" ></lightning-formatted-url></td>
                                                    <td><lightning-formatted-url value={file.TrackingURL} tooltip="Go to the file" label={file.TrackingName} target="_blank" ></lightning-formatted-url></td>
                                                    <td><div class={file.StatusTextColor}><lightning-formatted-text value={file.Status}></lightning-formatted-text></div></td>
                                                    <td><lightning-formatted-text value={file.ErrorMessage}></lightning-formatted-text></td>
                                                    <td><lightning-formatted-date-time value={file.CreatedDate}></lightning-formatted-date-time></td>
                                                </tr>
                                            </template>
                                        </tbody>
                                    </table>
                                </div>
                            </template>
                        </div>
                        <footer class="slds-modal__footer">
                            <lightning-button label="Close" variant="brand" onclick={saveMethod}></lightning-button>
                        </footer>
                    </div>
                </section>
                <div class="slds-backdrop slds-backdrop_open"></div>
            </div>
        </template>
    </lightning-card>
</template>